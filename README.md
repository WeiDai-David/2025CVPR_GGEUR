<!-- # 2025CVPR_GGEUR
è”é‚¦å­¦ä¹ ä¸­å‡ ä½•å¼•å¯¼çš„æœ¬åœ°å…¨å±€åˆ†å¸ƒå¯¹é½

æ‘˜è¦ï¼šè”é‚¦å­¦ä¹ ä¸­çš„æ•°æ®å¼‚è´¨æ€§ï¼Œå…¶ç‰¹å¾åœ¨äºå±€éƒ¨å’Œå…¨å±€åˆ†å¸ƒä¹‹é—´çš„æ˜¾è‘—ä¸ä¸€è‡´ï¼Œå¯¼è‡´å±€éƒ¨ä¼˜åŒ–æ–¹å‘ä¸åŒï¼Œå¹¶é˜»ç¢å…¨å±€æ¨¡å‹è®­ç»ƒã€‚ç°æœ‰çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨ä¼˜åŒ–æœ¬åœ°æ›´æ–°æˆ–å…¨å±€èšåˆï¼Œä½†è¿™äº›é—´æ¥æ–¹æ³•åœ¨å¤„ç†é«˜åº¦å¼‚æ„çš„æ•°æ®åˆ†å¸ƒæ—¶è¡¨ç°å‡ºä¸ç¨³å®šæ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨æ ‡ç­¾åæ–œå’ŒåŸŸåæ–œå…±å­˜çš„æƒ…å†µä¸‹ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§å‡ ä½•å¼•å¯¼çš„æ•°æ®å¢å¼ºæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¾§é‡äºåœ¨å±€éƒ¨æ¨¡æ‹Ÿå…¨å±€åµŒå…¥åˆ†å¸ƒã€‚æˆ‘ä»¬é¦–å…ˆå¼•å…¥äº†åµŒå…¥åˆ†å¸ƒå‡ ä½•å½¢çŠ¶çš„æ¦‚å¿µï¼Œå¹¶åœ¨éšç§çº¦æŸä¸‹è§£å†³äº†è·å–å…¨å±€å‡ ä½•å½¢çŠ¶çš„æŒ‘æˆ˜ã€‚éšåï¼Œæˆ‘ä»¬æå‡ºäº†GGEURï¼Œå®ƒåˆ©ç”¨å…¨å±€å‡ ä½•å½¢çŠ¶æ¥å¼•å¯¼æ–°æ ·æœ¬çš„ç”Ÿæˆï¼Œä»è€Œå®ç°å¯¹ç†æƒ³å…¨å±€åˆ†å¸ƒæ›´å¥½çš„è¿‘ä¼¼ã€‚åœ¨å•åŸŸçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡åŸºäºå…¨å±€å‡ ä½•å½¢çŠ¶çš„æ ·æœ¬å¢å¼ºæ¥æé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›ï¼›åœ¨å¤šåŸŸçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥é‡‡ç”¨ç±»åŸå‹æ¥æ¨¡æ‹Ÿè·¨åŸŸçš„å…¨å±€åˆ†å¸ƒã€‚å¤§é‡çš„å®éªŒç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨å¤„ç†é«˜åº¦å¼‚æ„çš„æ•°æ®æ—¶æ˜¾è‘—æå‡äº†æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨æ ‡ç­¾å€¾æ–œï¼ŒåŸŸå€¾æ–œï¼Œå’ŒäºŒè€…å…±å­˜çš„æƒ…å†µä¸‹ã€‚

å…³é”®è¯ï¼šè”é‚¦å­¦ä¹ ã€æ•°æ®å¼‚è´¨ã€åŸŸæ³›åŒ–ã€æ„ŸçŸ¥æµå½¢ -->

# 2025CVPR_GGEUR
**é¡¹ç›®æ•´ç†ä¸­ å¾…å®Œæˆçš„å·¥ä½œ 7/3/2025**ï¼š
(1):è‹±æ–‡ç‰ˆæœ¬
(2):å„ä¸ªå­å·¥ç¨‹è„šæœ¬åçš„é€»è¾‘é‡æ„
(3):å­å·¥ç¨‹å†…è„šæœ¬çš„é€»è¾‘å…³ç³»å›¾ å­å·¥ç¨‹é—´çš„é€»è¾‘å…³ç³»å›¾
(4):ç«™åœ¨æ¨¡å‹è§†é‡(æµå½¢ç©ºé—´)çš„è§’åº¦å°†æˆ‘ä»¬çš„æ€æƒ³ä»¥å›¾çš„æ–¹å¼å‰–æ
(5):æ›´ä¼˜ç¾æ›´é€»è¾‘çš„mdè¡¨è¿°

**Abstract:** Data heterogeneity in federated learning, characterized by a significant misalignment between local and global distributions, leads to divergent local optimization directions and hinders global model training. Existing studies mainly focus on optimizing local updates or global aggregation, but these indirect approaches demonstrate instability when handling highly heterogeneous data distributions, especially in scenarios where label skew and domain skew coexist. To address this, we propose a geometry-guided data generation method that centers on simulating the global embedding distribution locally. We first introduce the concept of the geometric shape of an embedding distribution and then address the challenge of obtaining global geometric shapes under privacy constraints. Subsequently, we propose GGEUR, which leverages global geometric shapes to guide the generation of new samples, enabling a closer approximation to the ideal global distribution. In singledomain scenarios, we augment samples based on global geometric shapes to enhance model generalization; in multidomain scenarios, we further employ class prototypes to simulate the global distribution across domains. Extensive experimental results demonstrate that our method significantly enhances the performance of existing approaches in handling highly heterogeneous data, including scenarios with label skew, domain skew, and their coexistence. Code published at: https://github.com/WeiDaiDavid/2025CVPR_GGEUR

**key word:** Federated Learning, Data Heterogeneity, Domain Generalization, Perceptual Manifold

## New Dataset Office-Home-LDS 

Dataset & constructor ï¼š <a href="https://huggingface.co/datasets/WeiDai-David/Office-Home-LDS" target="_blank">Huggingface</a>

The dataset is organized as follows:
```text
Office-Home-LDS/
â”œâ”€â”€ data/ 
â”‚   â””â”€â”€ Office-Home.zip        # Original raw dataset (compressed)
â”œâ”€â”€ new_dataset/               # Processed datasets based on different settings
â”‚   â”œâ”€â”€ Office-Home-0.1.zip    # Split with Dirichlet Î± = 0.1 (compressed)
â”‚   â”œâ”€â”€ Office-Home-0.5.zip    # Split with Dirichlet Î± = 0.5 (compressed)
â”‚   â””â”€â”€ Office-Home-0.05.zip   # Split with Dirichlet Î± = 0.05 (compressed)
â”œâ”€â”€ Dataset-Office-Home-LDS.py # Python script for processing and splitting Original raw dataset
â””â”€â”€ README.md                  # Project documentation
```
## Engineering 

Environmentï¼š
```bash
conda create -n GGEUR python=3.9
conda activate GGEUR

```



## Single Domain

1.Dataset Partitioning
CIFAR (10 & 100) dataset:
Dataset index parsing:
```text
The CIFAR dataset is sorted by subsets of the same class, so the indexing process is directly arranged by the number of classes
```
Optional parameters:
```bash
num_clients integer Number of clients
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
min_require_size æ•´æ•° æœ€å°åˆ†é…æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python data_distribution_CIFAR-10.py
python data_distribution_CIFAR-100.py
python data_batch2index_images.py  æ£€æŸ¥åˆ’åˆ†
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/context/alpha={alpha}_class_counts.txt  ç»Ÿè®¡åˆ’åˆ†åå„ç±»çš„æ€»æ•°(æ£€æŸ¥åˆ’åˆ†é”™è¯¯)
{æ•°æ®é›†åç§°}/context/alpha={alpha}_class_indices.txt  æ ¹æ®æ•°æ®é›†åˆ’åˆ†çš„æ•°æ®ç´¢å¼•
{æ•°æ®é›†åç§°}/context/alpha={alpha}_client_indices.txt  å„å®¢æˆ·ç«¯åˆ†é…åˆ°çš„æ•°æ®ç´¢å¼•
{æ•°æ®é›†åç§°}/context/alpha={alpha}_client_class_distribution.txt  å„å®¢æˆ·ç«¯ä¸‹å„ç±»çš„æ•°æ®åˆ†å¸ƒ
{æ•°æ®é›†åç§°}/images/alpha={alpha}_label_distribution_heatmap.png  å„å®¢æˆ·ç«¯åˆ†é…å„ç±»æ•°é‡çš„çƒ­åŠ›å›¾
```
TinyImageNetæ•°æ®é›†:
æ•°æ®é›†ç´¢å¼•è§£æï¼š
```bash
TinyImageNetæ•°æ®é›†æ¥æºäºImageNetçš„200ä¸ªç±»,åŒæ—¶å¹¶éçº¿æ€§æ’åˆ—,ä¸‹é¢æˆ‘ä»¬å°†è¿›è¡Œæ•°æ®é›†çš„é‡æ„
TinyImageNetæ•°æ®é›†çš„ç»“æ„:
â”‚
â”œâ”€â”€ train/
â”‚   â””â”€â”€ n01443537/   # ç±»åˆ«æ–‡ä»¶å¤¹
â”‚       â””â”€â”€ images/  # ç±»åˆ«å¯¹åº”çš„è®­ç»ƒå›¾åƒ
â”‚           â””â”€â”€ image_001.JPEG
â”‚           â””â”€â”€ image_002.JPEG
â”‚           â””â”€â”€ ...
â”œâ”€â”€ val/
â”‚   â”œâ”€â”€ images/      # éªŒè¯å›¾åƒ
â”‚   â””â”€â”€ val_annotations.txt  # å›¾åƒæ ‡ç­¾æ˜ å°„æ–‡ä»¶
â”‚
â”œâ”€â”€ test/
â”‚    â””â”€â”€ images/      # æµ‹è¯•å›¾åƒ
â”‚
â”œâ”€â”€ wnids.txt ç±»åˆ«å¯¹åº”çš„id
â”‚
â””â”€â”€ words.txt ç±»åˆ«å¯¹åº”çš„æ ‡ç­¾

æµ‹è¯•é›†æ²¡æœ‰æ ‡ç­¾,å› æ­¤æˆ‘ä»¬å°†éªŒè¯é›†ä½œä¸ºæµ‹è¯•é›†,è®­ç»ƒé›†éµå¾ªImageNetçš„æ–‡ä»¶å¤¹å±‚æ¬¡ç»“æ„,éªŒè¯é›†çš„å›¾ç‰‡
éƒ½å­˜å‚¨åœ¨val/imagesä¸­,val/val_annotations.txtå­˜å‚¨äº†éªŒè¯é›†å›¾ç‰‡å’Œæ ‡ç­¾idçš„æ˜ å°„å…³ç³»
é€šè¿‡Reorganized_TinyImageNet_Val.pyè„šæœ¬å°†éªŒè¯é›†çš„ç»“æ„å’Œè®­ç»ƒé›†ç»“æ„å¯¹é½ 

â”‚
â”œâ”€â”€ train/
â”‚   â””â”€â”€ n01443537/   # ç±»åˆ«æ–‡ä»¶å¤¹
â”‚       â””â”€â”€ images/  # ç±»åˆ«å¯¹åº”çš„è®­ç»ƒå›¾åƒ
â”‚           â””â”€â”€ image_001.JPEG
â”‚           â””â”€â”€ image_002.JPEG
â”‚           â””â”€â”€ ...
â”œâ”€â”€ new_val/
â”‚   â””â”€â”€ n01443537/   # ç±»åˆ«æ–‡ä»¶å¤¹
â”‚       â””â”€â”€ images/  # ç±»åˆ«å¯¹åº”çš„éªŒè¯å›¾åƒ
â”‚           â””â”€â”€ image_001.JPEG
â”‚           â””â”€â”€ image_002.JPEG
â”‚           â””â”€â”€ ...

æ¥ä¸‹æ¥,æˆ‘ä»¬éœ€è¦å¯¹æ ‡ç­¾id(n+8ä½æ•°)è¿›è¡Œç´¢å¼•,ä¸ºäº†ç»Ÿä¸€,æˆ‘ä»¬å°†æ ‡ç­¾idå»é™¤nåè¿›è¡Œæ’åº,ä»¥ç¡®å®šç´¢å¼•ç±»é¡ºåº
è¿™éƒ¨åˆ†å·¥ä½œåœ¨data_distribution_TinyImageNet.py(åˆ’åˆ†è®­ç»ƒé›†)TinyImageNet_Val.py(åˆ’åˆ†éªŒè¯é›†)ä¸­ä½“ç°
è‡³æ­¤,æˆ‘ä»¬å®ŒæˆTinyImageNetæ•°æ®é›†çš„é‡æ„,å¹¶æœªæ¥ä¸‹æ¥çš„ç´¢å¼•åˆ’åˆ†å·¥ä½œé“ºå«
```
å¯é€‰å‚æ•°:
```bash
num_clients æ•´æ•° å®¢æˆ·ç«¯æ•°é‡
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
min_require_size æ•´æ•° æœ€å°åˆ†é…æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python reorganized_TinyImageNet_val.py  é‡æ„éªŒè¯é›†
python TinyImageNet_val_index.py  éªŒè¯é›†ç´¢å¼•è½¬åŒ–
python data_distribution_TinyImageNet.py
python TinyImageNet_val_index_tag_img_matching_test.py æ£€æŸ¥éªŒè¯é›†å¤„ç†
python TinyImageNet_val_features.py æå–éªŒè¯é›†ç‰¹å¾
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/context/alpha={alpha}_class_counts.txt  ç»Ÿè®¡åˆ’åˆ†åå„ç±»çš„æ€»æ•°(æ£€æŸ¥åˆ’åˆ†é”™è¯¯)
{æ•°æ®é›†åç§°}/context/alpha={alpha}_class_indices.txt  æ ¹æ®æ•°æ®é›†åˆ’åˆ†çš„æ•°æ®ç´¢å¼•
{æ•°æ®é›†åç§°}/context/alpha={alpha}_client_indices.txt  å„å®¢æˆ·ç«¯åˆ†é…åˆ°çš„æ•°æ®ç´¢å¼•
{æ•°æ®é›†åç§°}/context/alpha={alpha}_client_class_distribution.txt  å„å®¢æˆ·ç«¯ä¸‹å„ç±»çš„æ•°æ®åˆ†å¸ƒ
{æ•°æ®é›†åç§°}/images/alpha={alpha}_label_distribution_heatmap.png  å„å®¢æˆ·ç«¯åˆ†é…å„ç±»æ•°é‡çš„çƒ­åŠ›å›¾
{æ•°æ®é›†åç§°}/context/class_map.txt  è®­ç»ƒé›†ç±»ç´¢å¼•å’Œæ ‡ç­¾idçš„æ˜ å°„
{æ•°æ®é›†åç§°}/val_context/class_map.txt  éªŒè¯é›†ç±»ç´¢å¼•å’Œæ ‡ç­¾idçš„æ˜ å°„
{æ•°æ®é›†åç§°}/val_context/val_indices.npy  éªŒè¯é›†æ•°æ®ç´¢å¼•
{æ•°æ®é›†åç§°}/val_context/val_labels.npy  éªŒè¯é›†æ•°æ®ç´¢å¼•å¯¹åº”çš„æ ‡ç­¾
{æ•°æ®é›†åç§°}/class_{class_label}_val_indices.npy  éªŒè¯é›†å„ç±»çš„æ•°æ®ç´¢å¼•
```

2.äº¤å‰ç´¢å¼•
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†CIFAR-10ã€CIFAR-100ã€TinyImageNetä¸‰ä¸ªæ•°æ®é›†,å„ä¸ªå®¢æˆ·ç«¯åˆ’åˆ†çš„æ•°æ®ç´¢å¼•,ç±»çš„æ•°æ®ç´¢å¼•
é€šè¿‡å°†ä¸¤è€…è¿›è¡Œäº¤å‰ç´¢å¼•,æˆ‘ä»¬èƒ½å¾—åˆ°å„ä¸ªå®¢æˆ·ç«¯ä¸‹å„ä¸ªç±»çš„æ•°æ®ç´¢å¼•,ä»¥CIFAR-10ä¸ºä¾‹ï¼š10ä¸ªå®¢æˆ·ç«¯*10ä¸ªç±»=100ä¸ªäº¤å‰ç´¢å¼•æ–‡ä»¶

å¯é€‰å‚æ•°:
```bash
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python client_class_cross_index.py
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/client_class_indices/alpha={alpha}_{dataset}_client_{client_id}_class_{class_id}_indices.npy
```

3.ç‰¹å¾æå–
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†ä¸‰ä¸ªæ•°æ®é›†ä¸‹,å„ä¸ªå®¢æˆ·ç«¯ä¸‹,å„ä¸ªç±»çš„ç´¢å¼•æ–‡ä»¶,ä½¿ç”¨CLIPä½œä¸ºBackbond,æˆ‘ä»¬å¯¹ç´¢å¼•æ–‡ä»¶é€ä¸ªè¿›è¡Œç‰¹å¾æå–
å¾—åˆ°å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶å’Œæ ‡ç­¾æ–‡ä»¶

å¯é€‰å‚æ•°:
```bash
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python client_class_clip_features2tensor.py
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/features/initial/alpha={alpha}_class_{class_idx}_client_{client_idx}/final_embeddings.npy
{æ•°æ®é›†åç§°}/features/initial/alpha={alpha}_class_{class_idx}_client_{client_idx}/labels.npy
```

4.å…¨å±€åˆ†å¸ƒ
4.1 å…¨å±€åˆ†å¸ƒçš„å®¢æˆ·ç«¯æˆåˆ†
åœ¨1.æ•°æ®é›†åˆ’åˆ†ä¸­å¾—åˆ°çš„alpha={alpha}_client_class_distribution.txt,é‡Œé¢å­˜å‚¨å„å®¢æˆ·ç«¯ä¸‹å„ç±»çš„æ•°æ®åˆ†å¸ƒ,
é€šè¿‡ç±»æ•°é‡å¯¹å®¢æˆ·ç«¯è¿›è¡Œæ’åº,æ ¹æ®é˜ˆå€¼æ¯”ä¾‹ç¡®å®šèƒ½è¿‘ä¼¼å…¨å±€åˆ†å¸ƒçš„å®¢æˆ·ç«¯é›†åˆ

å¯é€‰å‚æ•°:
```bash
threshold æµ®ç‚¹æ•° é˜ˆå€¼æ¯”ä¾‹
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python client-guided_set.py
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/context/alpha={alpha}_selected_clients_for_each_class.txt
```
4.2 å®¢æˆ·ç«¯é›†åˆçš„ç‰¹å¾(å¯çœç•¥)
åœ¨3.ç‰¹å¾æå–ä¸­å¾—åˆ°å„ä¸ªå®¢æˆ·ç«¯ä¸‹å„ä¸ªç±»çš„ç‰¹å¾æ–‡ä»¶,åœ¨4.1å…¨å±€åˆ†å¸ƒçš„å®¢æˆ·ç«¯æˆåˆ†ä¸­å¾—åˆ°å„ä¸ªç±»å…¨å±€åˆ†å¸ƒçš„å®¢æˆ·ç«¯ç»„æˆ
å°†åè€…å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶ä»å‰è€…ä¸­æŠ½å–
å¯é€‰å‚æ•°:
```bash
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python client-guided_clip_tensor.py
```
4.3 å…¨å±€åˆ†å¸ƒçš„è¡¨ç¤º
å¦‚æœå®¢æˆ·ç«¯é›†åˆåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œåˆ™ç›´æ¥å¯¹ç‰¹å¾çŸ©é˜µè¿›è¡Œåæ–¹å·®çŸ©é˜µçš„è®¡ç®—ï¼Œå¦‚æœå®¢æˆ·ç«¯é›†åˆç”±å¤šä¸ªå®¢æˆ·ç«¯ç»„æˆï¼Œåˆ™åˆ†åˆ«å¯¹
ç‰¹å¾çŸ©é˜µè¿›è¡Œåæ–¹å·®çŸ©é˜µçš„è®¡ç®—ï¼Œæœ€åå°†å¤šä¸ªåæ–¹å·®çŸ©é˜µè¿›è¡Œèšåˆï¼Œå¾—åˆ°èšåˆåæ–¹å·®çŸ©é˜µ
å¯é€‰å‚æ•°:
```bash
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python clip_tensor2aggregate_covariance_matrix.py
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/features/alpha={alpha}_cov_matrix/class_{idx}_cov_matrix.npy
```

5.å‡ ä½•å¼•å¯¼çš„æ•°æ®å¢å¼º
ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å…¨å±€åˆ†å¸ƒçš„éª¨æ¶(åæ–¹å·®çŸ©é˜µ),å°†åæ–¹å·®çŸ©é˜µåˆ†è§£å¾—åˆ°ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡(å‡ ä½•æ–¹å‘),åˆ©ç”¨å‡ ä½•æ–¹å‘
å¼•å¯¼å®¢æˆ·ç«¯ä¸­çš„åŸå§‹æ ·æœ¬è¿›è¡Œæ•°æ®å¢å¼º
å¯é€‰å‚æ•°:
```bash
dataset å­—ç¬¦ä¸² æ•°æ®é›†åç§°(ä¸‰ä¸ªæ•°æ®é›†)
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python cov_matrix_generate_features.py
```
è¿è¡Œç»“æœ:
```bash
{æ•°æ®é›†åç§°}/features/alpha={alpha}_complete/final_embeddings_filled.npy
{æ•°æ®é›†åç§°}/features/alpha={alpha}_complete/labels_filled.npy
```

6.å•å®¢æˆ·ç«¯è®­ç»ƒ
åœ¨éè”é‚¦å­¦ä¹ æ¶æ„ä¸‹,æœ¬åœ°è®­ç»ƒåŸå§‹æ ·æœ¬å’Œå¢å¼ºæ ·æœ¬,æ¯”è¾ƒæ€§èƒ½å·®å¼‚

å¯é€‰å‚æ•°:
```bash
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
client_idx æ•´æ•° å®¢æˆ·ç«¯ç¼–å·
batch_size æ•´æ•° æ‰¹æ¬¡å¤§å°
learning_rate æµ®ç‚¹æ•° å­¦ä¹ ç‡
num_epochs æ•´æ•° è®­ç»ƒæ¬¡æ•°
```
æ‰§è¡Œè„šæœ¬:
```bash
python MLP_10.py  CIFAR-10æ•°æ®é›†è®­ç»ƒ
python MLP_100.py  CIFAR-100æ•°æ®é›†è®­ç»ƒ
python MLP_200.py  TinyImageNetæ•°æ®é›†è®­ç»ƒ
```

7.è”é‚¦æ¶æ„FedAvgè®­ç»ƒ
åœ¨æœ€ç®€å•çš„è”é‚¦å­¦ä¹ æ¶æ„FedAvg(ç®€å•å¹³å‡èšåˆ)ä¸‹,è®­ç»ƒåŸå§‹æ ·æœ¬æ¨¡å‹å’Œå¢å¼ºæ ·æœ¬æ¨¡å‹,,æ¯”è¾ƒæ€§èƒ½å·®å¼‚
å¯é€‰å‚æ•°:
```bash
alpha æµ®ç‚¹æ•° ç‹„åˆ©å…‹é›·ç³»æ•°
communication_rounds æ•´æ•° é€šä¿¡è½®æ•°
local_epochs æ•´æ•° æœ¬åœ°è®­ç»ƒæ¬¡æ•°
client_count æ•´æ•° å®¢æˆ·ç«¯æ•°é‡
batch_size æ•´æ•° æ‰¹æ¬¡å¤§å°
learning_rate æµ®ç‚¹æ•° å­¦ä¹ ç‡
```
æ‰§è¡Œè„šæœ¬:
```bash
python FL_MLP_10.py  CIFAR-10æ•°æ®é›†è®­ç»ƒ
python FL_MLP_100.py  CIFAR-100æ•°æ®é›†è®­ç»ƒ
python FL_MLP_200.py  TinyImageNetæ•°æ®é›†è®­ç»ƒ
```

## è·¨åŸŸæƒ…å†µ 
æˆ‘ä»¬åˆ†åˆ«å¯¹Digitsã€PACSã€office_caltech_10æ•°æ®é›†è¿›è¡Œå®éªŒ,è€Œåæå‡ºæ–°æ•°æ®é›†Office-Home-LDS
Digits:
1.æ•°æ®é›†ä»‹ç»ï¼š
Digits æ•°æ®é›†åŒ…å«å››ä¸ªä¸åŒçš„åŸŸï¼ˆdomainsï¼‰çš„æ•°æ®ï¼Œç±»åˆ«ä¸ºæ•°å­—0-9è¿™åç§ç±»åˆ«
(1): MNISTï¼ˆMixed National Institute of Standards and Technologyï¼‰ï¼šä¸åŒäººæ‰‹å†™çš„æ•°å­—ï¼ˆ0-9ï¼‰
(2): SVHNï¼ˆStreet View House Numbersï¼‰ï¼šè°·æ­Œè¡—æ™¯çš„é—¨ç‰Œå·è£å‰ªæˆæ•°å­—ï¼ˆ0-9ï¼‰
(3): USPSï¼ˆUnited States Postal Serviceï¼‰ï¼šç¾å›½é‚®æ”¿ç¼–å·è£å‰ªçš„æ•°å­—ï¼ˆ0-9ï¼‰
(4): SynthDigitsï¼ˆSynthetic Digitsï¼‰ï¼šåˆæˆæ–¹æ³•ç”Ÿæˆçš„å½©è‰²ï¼ˆRGBï¼‰çš„æ•°å­—ï¼ˆ0-9ï¼‰
2.æ•°æ®é›†åˆ’åˆ†
æˆ‘ä»¬éµå¾ªè”é‚¦è·¨åŸŸä»¥å¾€çš„å·¥ä½œè®¾ç½®ï¼šä¸€ä¸ªå®¢æˆ·ç«¯åˆ’åˆ†ä¸€ä¸ªåŸŸï¼ŒåŒæ—¶å„å®¢æˆ·ç«¯æŒ‰ç…§æ¯”ä¾‹è¿›è¡Œéšæœºåˆ’åˆ†
æ‰§è¡Œè„šæœ¬:
```bash
python data_distribution_digits.py
```
è¿è¡Œç»“æœ:
```bash
output_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_indices.npy  è¯¥åŸŸå†…å®¢æˆ·ç«¯åˆ’åˆ†çš„ç´¢å¼•
output_indices/{åŸŸåç§°}/combined_class_indices.npy  è¯¥åŸŸå†…å„ç±»çš„ç´¢å¼•é›†åˆ
output_indices/client_combined_class_distribution.txt  å„åŸŸåˆ†é…ç»™å¯¹åº”å®¢æˆ·ç«¯å„ç±»çš„æ•°æ®åˆ†å¸ƒ
output_indices/dataset_report.txt  å„åŸŸåˆ†é…ç»™å¯¹åº”å®¢æˆ·ç«¯çš„æ€»æ•°(æ£€æŸ¥åˆ’åˆ†é”™è¯¯)
```
3.äº¤å‰ç´¢å¼•
æˆ‘ä»¬å·²ç»å¾—åˆ°æŸåŸŸå¯¹åº”çš„å®¢æˆ·ç«¯åœ¨è¯¥åŸŸåˆ’åˆ†çš„æ•°æ®ç´¢å¼•,ä»¥åŠè¯¥åŸŸçš„ç±»åˆ«ç´¢å¼•,é€šè¿‡äº¤å‰ç´¢å¼•,æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥åŸŸå¯¹åº”å®¢æˆ·ç«¯çš„å„ç±»çš„ç´¢å¼•æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python äº¤å‰ç´¢å¼•.py
```
è¿è¡Œç»“æœ:
```bash
output_client_class_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_indices.npy
```
4.è®­ç»ƒé›†ç‰¹å¾æå–
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å››ä¸ªåŸŸå¯¹åº”çš„å››ä¸ªå®¢æˆ·ç«¯ä¸‹,,å„ä¸ªç±»çš„ç´¢å¼•æ–‡ä»¶,ä½¿ç”¨CLIPä½œä¸ºBackbond,æˆ‘ä»¬å¯¹ç´¢å¼•æ–‡ä»¶é€ä¸ªè¿›è¡Œç‰¹å¾æå–å¾—åˆ°å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶å’Œæ ‡ç­¾æ–‡ä»¶
å¯é€‰å‚æ•°:
```bash
datasets å­—ç¬¦ä¸² åŸŸåç§°(å››ä¸ªå¯é€‰åŸŸ)
report_file å­—ç¬¦ä¸² åŸŸå’Œå®¢æˆ·ç«¯çš„æ˜ å°„æ–‡ä»¶
```
æ‰§è¡Œè„šæœ¬:
```bash
python è®­ç»ƒé›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_original_features.npy
clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_labels.npy
```
5.æµ‹è¯•é›†ç‰¹å¾æå–
å¯é€‰å‚æ•°:
```bash
datasets å­—ç¬¦ä¸² åŸŸåç§°(å››ä¸ªå¯é€‰åŸŸ)
```
æ‰§è¡Œè„šæœ¬:
```bash
python æµ‹è¯•é›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_features.npy
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_labels.npy
```
6.æå–åŸå‹
é€šè¿‡å‰é¢å¾—åˆ°çš„å®¢æˆ·ç«¯ç±»åˆ«ç´¢å¼•æ–‡ä»¶ï¼Œå¯ä»¥æå–å¯¹åº”çš„ç±»åŸå‹
æ‰§è¡Œè„šæœ¬:
```bash
python æå–åŸå‹.py
```
è¿è¡Œç»“æœ:
```bash
clip_prototypes/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_prototype.npy
```
7.å‡ ä½•æ–¹å‘
åœ¨æµå½¢ç©ºé—´çš„è§†è§’ï¼Œè·¨åŸŸçš„æœ¬è´¨æ˜¯ç±»å¯¹åº”çš„æµå½¢åˆ†å¸ƒå‘ç”Ÿæ¨ªå‘çš„åç§»ï¼Œå‡ ä½•æ–¹å‘å¹¶æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤šåŸŸçš„åˆå¹¶ç‰¹å¾æ¥è¡¨ç¤ºå‡ ä½•å½¢çŠ¶
```bash
report_file å­—ç¬¦ä¸² åŸŸå’Œå®¢æˆ·ç«¯çš„æ˜ å°„æ–‡ä»¶
```
æ‰§è¡Œè„šæœ¬:
```bash
python èšåˆåæ–¹å·®çŸ©é˜µ4x10=10.py
```
è¿è¡Œç»“æœ:
```bash
cov_matrix_output/class_{0~9}_cov_matrix.npy
```
8.å‡ ä½•å¼•å¯¼çš„æ•°æ®å¢å¼º
ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°äº†åˆ†å¸ƒçš„å‡ ä½•æ–¹å‘å’Œå¤šä¸ªåŸŸå¯¹åº”çš„ç±»åŸå‹ï¼Œåœ¨å®¢æˆ·ç«¯è¿›è¡Œæ•°æ®å¢å¼ºï¼Œå®¢æˆ·ç«¯æœ¬åŸŸï¼Œè¿›è¡Œå•åŸŸæ•°æ®å¢å¼ºç­–ç•¥ï¼Œéæœ¬åŸŸï¼Œåˆ™ä»¥ç±»åŸå‹ä¸ºä¸­å¿ƒè¿›è¡Œå‡ ä½•æ–¹å‘çš„å¢å¼ºï¼Œè¿™æ ·å³ä½¿åœ¨å®¢æˆ·ç«¯è§†è§’ï¼Œä¹Ÿèƒ½å­¦ä¹ åˆ°è·¨åŸŸçš„ç‰¹å¾ï¼Œä»è€Œæœ‰æ•ˆçš„ç¼“è§£åŸŸåç§»å¸¦æ¥çš„åå·®
æ‰§è¡Œè„šæœ¬:
```bash
python æ‰©å……-æ”¾å¤§èšåˆåæ–¹å·®çŸ©é˜µ-ç±»åŸå‹-ç±»ä¸­å¿ƒ.py
```
è¿è¡Œç»“æœ:
```bash
argumented_clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}/final_embeddings_filled.npy
argumented_clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}/labels_filled.npy
```
9.ä¸åŒè”é‚¦æ¶æ„è®­ç»ƒ
æ‰§è¡Œè„šæœ¬:
```bash
python FedAvgè”é‚¦åŸå§‹ç‰¹å¾.py 
python FedAvgè”é‚¦è¡¥å…¨ç‰¹å¾.py 
python FedNTDè”é‚¦åŸå§‹ç‰¹å¾.py
python FedNTDè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedOptè”é‚¦åŸå§‹ç‰¹å¾.py
python FedOptè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedProxè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProxè”é‚¦è¡¥å…¨ç‰¹å¾.py
python MOONè”é‚¦åŸå§‹ç‰¹å¾.py
python MOONè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedDynè”é‚¦åŸå§‹ç‰¹å¾.py
python FedDynè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedProtoè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProtoè”é‚¦è¡¥å…¨ç‰¹å¾.py
python SCAFFOLDè”é‚¦åŸå§‹ç‰¹å¾.py
python SCAFFOLDè”é‚¦è¡¥å…¨ç‰¹å¾.py
```

PACSå’Œoffice_caltech_10æ˜¯å°æ ·æœ¬æ•°æ®é›†å’Œå°‘åˆ†ç±»ä»»åŠ¡
å°‘åˆ†ç±»ä»»åŠ¡-åˆ†ç±»éš¾åº¦ä½
ç±»é—´å·®å¼‚å¤§-æœ‰åˆ©äºåŒºåˆ†
å°æ ·æœ¬æ•°æ®é›†ä¸­åˆ’åˆ†è®­ç»ƒé›†æµ‹è¯•é›†-è®­ç»ƒé›†å’Œæµ‹è¯•é›†ç›¸ä¼¼-éšå¼æé«˜ç²¾åº¦
åŒåŸŸç±»åˆ’åˆ†ç›¸å¯¹å¹³è¡¡(å› ä¸ºæ˜¯æŒ‰æ¯”ä¾‹éšæœºåˆ’åˆ†ï¼Œè¿™æ˜¯è·¨åŸŸåˆ’åˆ†çš„é€šç—…)

éšç€è‡ªç›‘ç£å­¦ä¹ çš„å‘å±•ï¼Œé¢å‘ä»¥clipã€dinoä¸ºä»£è¡¨çš„Backbondæ—¶ï¼ŒPACSå’Œoffice_caltech_10è¿™ç±»è·¨åŸŸæ•°æ®é›†çš„æŒ‘æˆ˜è¢«å¤§å¤§çš„å‰Šå¼±ï¼Œå› æ­¤æˆ‘ä»¬è¿«åˆ‡çš„éœ€è¦ä¸€ç§æ›´ç¬¦åˆç°å®åœºæ™¯ä¸”æ›´å…·æœ‰æŒ‘æˆ˜çš„æ•°æ®é›†ï¼Œå› æ­¤æˆ‘ä»¬æå‡ºäº†Office-Home-LDSï¼Œå®ƒåœ¨Office-Homeæ•°æ®é›†(65åˆ†ç±»)çš„åŸºç¡€ä¸Šèåˆäº†è·¨åŸŸå’Œæ•°æ®å¼‚è´¨ï¼Œæ˜¾ç„¶ï¼Œè¿™æ›´ç¬¦åˆçœŸå®ä¸–ç•Œã€‚

PACS:
1.æ•°æ®é›†ä»‹ç»ï¼š
PACS æ•°æ®é›†åŒ…å«å››ä¸ªä¸åŒçš„åŸŸï¼ˆdomainsï¼‰çš„æ•°æ®ï¼ŒåŒ…å«ä¸ƒä¸ªç±»åˆ«:Dogã€Elephantã€Giraffeã€Guitarã€Horseã€Houseã€Person
(1): Pï¼ˆPhotoï¼‰: çœŸå®ç…§ç‰‡
(2): Aï¼ˆArt Paintingï¼‰: è‰ºæœ¯ç»˜ç”»
(3): Cï¼ˆCartoonï¼‰: å¡é€š
(4): Sï¼ˆSketchï¼‰: ç´ æ
2.æ•°æ®é›†åˆ’åˆ†
æˆ‘ä»¬éµå¾ªè”é‚¦è·¨åŸŸä»¥å¾€çš„å·¥ä½œè®¾ç½®ï¼šä¸€ä¸ªå®¢æˆ·ç«¯åˆ’åˆ†ä¸€ä¸ªåŸŸï¼ŒåŒæ—¶å„å®¢æˆ·ç«¯æŒ‰ç…§æ¯”ä¾‹ä»è®­ç»ƒé›†ä¸­éšæœºåˆ’åˆ†,å¯¹äºæ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ•°æ®é›†ï¼Œéµå¾ªä»¥å¾€å·¥ä½œçš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†
æ‰§è¡Œè„šæœ¬:
```bash
python data_distribution_digits.py
```
è¿è¡Œç»“æœ:
```bash
./output_indices/{åŸŸåç§°}/train_train_indices.npy è¯¥åŸŸæ•°æ®é›†åˆ’åˆ†çš„è®­ç»ƒé›†ç´¢å¼•
./output_indices/{åŸŸåç§°}/test_test_indices.npy è¯¥åŸŸæ•°æ®é›†åˆ’åˆ†çš„æµ‹è¯•é›†ç´¢å¼•
./output_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_indices.npy  è¯¥åŸŸå†…å®¢æˆ·ç«¯åˆ’åˆ†çš„ç´¢å¼•
./output_indices/{åŸŸåç§°}/class_indices.npy  è¯¥åŸŸå†…å„ç±»çš„ç´¢å¼•é›†åˆ
./output_indices/client_combined_class_distribution.txt  å„åŸŸåˆ†é…ç»™å¯¹åº”å®¢æˆ·ç«¯å„ç±»çš„æ•°æ®åˆ†å¸ƒ
```
3.äº¤å‰ç´¢å¼•
æˆ‘ä»¬å·²ç»å¾—åˆ°æŸåŸŸå¯¹åº”çš„å®¢æˆ·ç«¯åœ¨è¯¥åŸŸåˆ’åˆ†çš„æ•°æ®ç´¢å¼•,ä»¥åŠè¯¥åŸŸçš„ç±»åˆ«ç´¢å¼•,é€šè¿‡äº¤å‰ç´¢å¼•,æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥åŸŸå¯¹åº”å®¢æˆ·ç«¯çš„å„ç±»çš„ç´¢å¼•æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python äº¤å‰ç´¢å¼•.py
```
è¿è¡Œç»“æœ:
```bash
output_client_class_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~6}_indices.npy
```
4.è®­ç»ƒé›†ç‰¹å¾æå–
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å››ä¸ªåŸŸå¯¹åº”çš„å››ä¸ªå®¢æˆ·ç«¯ä¸‹,,å„ä¸ªç±»çš„ç´¢å¼•æ–‡ä»¶,ä½¿ç”¨CLIPä½œä¸ºBackbond,æˆ‘ä»¬å¯¹ç´¢å¼•æ–‡ä»¶é€ä¸ªè¿›è¡Œç‰¹å¾æå–å¾—åˆ°å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶å’Œæ ‡ç­¾æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python è®­ç»ƒé›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_pacs_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~6}_original_features.npy
clip_pacs_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~6}_labels.npy
```
5.æµ‹è¯•é›†ç‰¹å¾æå–
æ‰§è¡Œè„šæœ¬:
```bash
python æµ‹è¯•é›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_features.npy
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_labels.npy
```
6.ä¸åŒè”é‚¦æ¶æ„è®­ç»ƒ
æ‰§è¡Œè„šæœ¬:
```bash
python FedAvgè”é‚¦åŸå§‹ç‰¹å¾.py 
python FedNTDè”é‚¦åŸå§‹ç‰¹å¾.py
python FedOptè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProxè”é‚¦åŸå§‹ç‰¹å¾.py
python MOONè”é‚¦åŸå§‹ç‰¹å¾.py
python FedDynè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProtoè”é‚¦åŸå§‹ç‰¹å¾.py
python SCAFFOLDè”é‚¦åŸå§‹ç‰¹å¾.py
```

office_caltech_10:
1.æ•°æ®é›†ä»‹ç»ï¼š
office_caltech_10 æ•°æ®é›†åŒ…å«å››ä¸ªä¸åŒçš„åŸŸï¼ˆdomainsï¼‰çš„æ•°æ®ï¼ŒåŒ…å«åä¸ªç±»åˆ«:Backpackã€Calculatorã€
Headphonesã€Keyboardã€Laptopã€Monitorã€Mouseã€Mugã€Projectorã€Bike
(1): Amazon (A): æ¥è‡ª Amazon çš„å•†å“å›¾ç‰‡
(2): Webcam (W): é€šè¿‡ç½‘ç»œæ‘„åƒå¤´æ‹æ‘„çš„å›¾åƒ
(3): DSLR (D): ç”±æ•°ç å•åç›¸æœºæ‹æ‘„çš„å›¾åƒ
(4): Caltech-256 (C): ä» Caltech-256 æ•°æ®é›†ä¸­é€‰å–çš„å›¾åƒ
2.æ•°æ®é›†åˆ’åˆ†
æˆ‘ä»¬éµå¾ªè”é‚¦è·¨åŸŸä»¥å¾€çš„å·¥ä½œè®¾ç½®ï¼šä¸€ä¸ªå®¢æˆ·ç«¯åˆ’åˆ†ä¸€ä¸ªåŸŸï¼ŒåŒæ—¶å„å®¢æˆ·ç«¯æŒ‰ç…§æ¯”ä¾‹ä»è®­ç»ƒé›†ä¸­éšæœºåˆ’åˆ†,å¯¹äºæ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ•°æ®é›†ï¼Œéµå¾ªä»¥å¾€å·¥ä½œçš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†
æ‰§è¡Œè„šæœ¬:
```bash
python data_distribution_office_caltech_10.py
```
è¿è¡Œç»“æœ:
```bash
output_indices/{åŸŸåç§°}/train_train_indices.npy è¯¥åŸŸæ•°æ®é›†åˆ’åˆ†çš„è®­ç»ƒé›†ç´¢å¼•
output_indices/{åŸŸåç§°}/test_test_indices.npy åŸŸæ•°æ®é›†åˆ’åˆ†çš„æµ‹è¯•é›†ç´¢å¼•
output_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_indices.npy  è¯¥åŸŸå†…å®¢æˆ·ç«¯åˆ’åˆ†çš„ç´¢å¼•
output_indices/{åŸŸåç§°}/class_indices.npy  è¯¥åŸŸå†…å„ç±»çš„ç´¢å¼•é›†åˆ
output_indices/client_combined_class_distribution.txt  å„åŸŸåˆ†é…ç»™å¯¹åº”å®¢æˆ·ç«¯å„ç±»çš„æ•°æ®åˆ†å¸ƒ
```
3.äº¤å‰ç´¢å¼•
æˆ‘ä»¬å·²ç»å¾—åˆ°æŸåŸŸå¯¹åº”çš„å®¢æˆ·ç«¯åœ¨è¯¥åŸŸåˆ’åˆ†çš„æ•°æ®ç´¢å¼•,ä»¥åŠè¯¥åŸŸçš„ç±»åˆ«ç´¢å¼•,é€šè¿‡äº¤å‰ç´¢å¼•,æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥åŸŸå¯¹åº”å®¢æˆ·ç«¯çš„å„ç±»çš„ç´¢å¼•æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python äº¤å‰ç´¢å¼•.py
```
è¿è¡Œç»“æœ:
```bash
output_client_class_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_indices.npy
```
4.è®­ç»ƒé›†ç‰¹å¾æå–
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å››ä¸ªåŸŸå¯¹åº”çš„å››ä¸ªå®¢æˆ·ç«¯ä¸‹,,å„ä¸ªç±»çš„ç´¢å¼•æ–‡ä»¶,ä½¿ç”¨CLIPä½œä¸ºBackbond,æˆ‘ä»¬å¯¹ç´¢å¼•æ–‡ä»¶é€ä¸ªè¿›è¡Œç‰¹å¾æå–å¾—åˆ°å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶å’Œæ ‡ç­¾æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python è®­ç»ƒé›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_pacs_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_original_features.npy
clip_pacs_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~9}_labels.npy
```
5.æµ‹è¯•é›†ç‰¹å¾æå–
æ‰§è¡Œè„šæœ¬:
```bash
python æµ‹è¯•é›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_features.npy
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_labels.npy
```
6.ä¸åŒè”é‚¦æ¶æ„è®­ç»ƒ
æ‰§è¡Œè„šæœ¬:
```bash
python FedAvgè”é‚¦åŸå§‹ç‰¹å¾.py 
python FedNTDè”é‚¦åŸå§‹ç‰¹å¾.py
python FedOptè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProxè”é‚¦åŸå§‹ç‰¹å¾.py
python MOONè”é‚¦åŸå§‹ç‰¹å¾.py
python FedDynè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProtoè”é‚¦åŸå§‹ç‰¹å¾.py
python SCAFFOLDè”é‚¦åŸå§‹ç‰¹å¾.py
```

Office-Home-LDS:
1.æ•°æ®é›†ä»‹ç»ï¼š
Office-Home-LDS æ•°æ®é›†åŒ…å«å››ä¸ªä¸åŒçš„åŸŸï¼ˆdomainsï¼‰çš„æ•°æ®ï¼Œæœ‰65ä¸ªç±»åˆ«
(1): Artï¼š æ‰‹ç»˜ã€ç´ ææˆ–æ²¹ç”»é£æ ¼çš„å›¾åƒ
(2): Clipartï¼š æ¥è‡ªç½‘ç»œçš„å¡é€šå’Œå‰ªè´´ç”»å›¾åƒ
(3): Productï¼š	äº§å“å›¾ç‰‡æˆ–å•†å“å±•ç¤ºå›¾
(4): Real Worldï¼š ç°å®åœºæ™¯ä¸­æ‹æ‘„çš„å›¾åƒ
2.æ•°æ®é›†åˆ’åˆ†
æˆ‘ä»¬éµå¾ªè”é‚¦è·¨åŸŸä»¥å¾€çš„å·¥ä½œè®¾ç½®ï¼šä¸€ä¸ªå®¢æˆ·ç«¯åˆ’åˆ†ä¸€ä¸ªåŸŸï¼ŒåŒæ—¶å„å®¢æˆ·ç«¯æŒ‰ç…§ç‹„åˆ©å…‹é›·çŸ©é˜µä¸­çš„æ¯”ä¾‹ä»è®­ç»ƒé›†ä¸­éšæœºåˆ’åˆ†,å¯¹äºæ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ•°æ®é›†ï¼Œéµå¾ªä»¥å¾€å·¥ä½œçš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†
æ‰§è¡Œè„šæœ¬:
```bash
python data_distribution_Office_Home_LDS.py
```
è¿è¡Œç»“æœ:
```bash
./output_indices/{åŸŸåç§°}/train_train_indices.npy è¯¥åŸŸæ•°æ®é›†åˆ’åˆ†çš„è®­ç»ƒé›†ç´¢å¼•
./output_indices/{åŸŸåç§°}/test_test_indices.npy è¯¥åŸŸæ•°æ®é›†åˆ’åˆ†çš„æµ‹è¯•é›†ç´¢å¼•
./output_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_indices.npy è¯¥åŸŸå†…å®¢æˆ·ç«¯åˆ’åˆ†çš„ç´¢å¼•
./output_indices/{åŸŸåç§°}/class_indices.npy è¯¥åŸŸå†…å„ç±»çš„ç´¢å¼•é›†åˆ
./output_indices/client_combined_class_distribution.txt å„åŸŸåˆ†é…ç»™å¯¹åº”å®¢æˆ·ç«¯å„ç±»çš„æ•°æ®åˆ†å¸ƒ
```
3.äº¤å‰ç´¢å¼•
æˆ‘ä»¬å·²ç»å¾—åˆ°æŸåŸŸå¯¹åº”çš„å®¢æˆ·ç«¯åœ¨è¯¥åŸŸåˆ’åˆ†çš„æ•°æ®ç´¢å¼•,ä»¥åŠè¯¥åŸŸçš„ç±»åˆ«ç´¢å¼•,é€šè¿‡äº¤å‰ç´¢å¼•,æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥åŸŸå¯¹åº”å®¢æˆ·ç«¯çš„å„ç±»çš„ç´¢å¼•æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python äº¤å‰ç´¢å¼•.py
```
è¿è¡Œç»“æœ:
```bash
output_client_class_indices/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}_indices.npy
```
4.è®­ç»ƒé›†ç‰¹å¾æå–
æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å››ä¸ªåŸŸå¯¹åº”çš„å››ä¸ªå®¢æˆ·ç«¯ä¸‹,,å„ä¸ªç±»çš„ç´¢å¼•æ–‡ä»¶,ä½¿ç”¨CLIPä½œä¸ºBackbond,æˆ‘ä»¬å¯¹ç´¢å¼•æ–‡ä»¶é€ä¸ªè¿›è¡Œç‰¹å¾æå–å¾—åˆ°å¯¹åº”çš„ç‰¹å¾æ–‡ä»¶å’Œæ ‡ç­¾æ–‡ä»¶
æ‰§è¡Œè„šæœ¬:
```bash
python è®­ç»ƒé›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_office_home_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}_original_features.npy
clip_office_home_train_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}_labels.npy
```
5.æµ‹è¯•é›†ç‰¹å¾æå–
æ‰§è¡Œè„šæœ¬:
```bash
python æµ‹è¯•é›†ç‰¹å¾.py
```
è¿è¡Œç»“æœ:
```bash
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_features.npy
clip_test_features/{åŸŸåç§°}/{åŸŸåç§°}_test_labels.npy
```
6.æå–åŸå‹
é€šè¿‡å‰é¢å¾—åˆ°çš„å®¢æˆ·ç«¯ç±»åˆ«ç´¢å¼•æ–‡ä»¶ï¼Œå¯ä»¥æå–å¯¹åº”çš„ç±»åŸå‹
æ‰§è¡Œè„šæœ¬:
```bash
python æå–åŸå‹.py
```
è¿è¡Œç»“æœ:
```bash
./office_home_prototypes/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}_prototype.npy
```
7.å‡ ä½•æ–¹å‘
åœ¨æµå½¢ç©ºé—´çš„è§†è§’ï¼Œè·¨åŸŸçš„æœ¬è´¨æ˜¯ç±»å¯¹åº”çš„æµå½¢åˆ†å¸ƒå‘ç”Ÿæ¨ªå‘çš„åç§»ï¼Œå‡ ä½•æ–¹å‘å¹¶æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤šåŸŸçš„åˆå¹¶ç‰¹å¾æ¥è¡¨ç¤ºå‡ ä½•å½¢çŠ¶
```bash
report_file å­—ç¬¦ä¸² åŸŸå’Œå®¢æˆ·ç«¯çš„æ˜ å°„æ–‡ä»¶
```
æ‰§è¡Œè„šæœ¬:
```bash
python èšåˆåæ–¹å·®çŸ©é˜µ4x65=65.py
```
è¿è¡Œç»“æœ:
```bash
cov_matrix_output/class_{0~64}_cov_matrix.npy
```
8.å‡ ä½•å¼•å¯¼çš„æ•°æ®å¢å¼º
ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°äº†åˆ†å¸ƒçš„å‡ ä½•æ–¹å‘å’Œå¤šä¸ªåŸŸå¯¹åº”çš„ç±»åŸå‹ï¼Œåœ¨å®¢æˆ·ç«¯è¿›è¡Œæ•°æ®å¢å¼ºï¼Œå®¢æˆ·ç«¯æœ¬åŸŸï¼Œè¿›è¡Œå•åŸŸæ•°æ®å¢å¼ºç­–ç•¥ï¼Œéæœ¬åŸŸï¼Œåˆ™ä»¥ç±»åŸå‹ä¸ºä¸­å¿ƒè¿›è¡Œå‡ ä½•æ–¹å‘çš„å¢å¼ºï¼Œè¿™æ ·å³ä½¿åœ¨å®¢æˆ·ç«¯è§†è§’ï¼Œä¹Ÿèƒ½å­¦ä¹ åˆ°è·¨åŸŸçš„ç‰¹å¾ï¼Œä»è€Œæœ‰æ•ˆçš„ç¼“è§£åŸŸåç§»å¸¦æ¥çš„åå·®
æ‰§è¡Œè„šæœ¬:
```bash
python æ‰©å……-æ”¾å¤§èšåˆåæ–¹å·®çŸ©é˜µ-ç±»åŸå‹-ç±»ä¸­å¿ƒ-å°é¡¶.py.py
```
è¿è¡Œç»“æœ:
```bash
argumented_clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}/final_embeddings_filled.npy
argumented_clip_features/{åŸŸåç§°}/client_{åŸŸå¯¹åº”çš„å®¢æˆ·ç«¯ç¼–å·}_class_{0~64}/labels_filled.npy
```
9.ä¸åŒè”é‚¦æ¶æ„è®­ç»ƒ
æ‰§è¡Œè„šæœ¬:
```bash
python FedAvgè”é‚¦åŸå§‹ç‰¹å¾.py 
python FedAvgè”é‚¦è¡¥å…¨ç‰¹å¾.py 
python FedNTDè”é‚¦åŸå§‹ç‰¹å¾.py
python FedNTDè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedOptè”é‚¦åŸå§‹ç‰¹å¾.py
python FedOptè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedProxè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProxè”é‚¦è¡¥å…¨ç‰¹å¾.py
python MOONè”é‚¦åŸå§‹ç‰¹å¾.py
python MOONè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedDynè”é‚¦åŸå§‹ç‰¹å¾.py
python FedDynè”é‚¦è¡¥å…¨ç‰¹å¾.py
python FedProtoè”é‚¦åŸå§‹ç‰¹å¾.py
python FedProtoè”é‚¦è¡¥å…¨ç‰¹å¾.py
python SCAFFOLDè”é‚¦åŸå§‹ç‰¹å¾.py
python SCAFFOLDè”é‚¦è¡¥å…¨ç‰¹å¾.py
```
## Learning Trajectory (Updating...)

When I completed this project, I was a third-year undergraduate student. ğŸŒ¿ I will share my learning trajectory and how to efficiently and comprehensively develop expertise in a specific field. ğŸŒŠ I believe that the most effective approach is to start by identifying high-quality review articles from top-tier journals. ğŸ“š After forming a comprehensive understanding of the field, I recommend selecting detailed papers from the references cited in these outstanding reviews, focusing on those that align with the direction of our current work for in-depth study. ğŸ” This process resembles a leaf with its veins hollowed out â€” our process of understanding is akin to a flood flowing through the leaf, with the central vein serving as the core from which knowledge selectively branches out in all directions. ğŸš€

+ **2023Tpami**  "Deep Long-Tailed Learning: A Survey"[Paper](https://arxiv.org/pdf/2304.00685)â€”â€”Review on Long-Tailed Learning 

+ **2024Tpami** "Vision-Language Models for Vision Tasks: A Survey" [Paper](https://arxiv.org/pdf/2304.00685) & [Github](https://github.com/jingyi0000/VLM_survey)â€”â€”Review on Vision-Language Large Models

+ **2024Tpami**  "Federated Learning for Generalization, Robustness, Fairness: A Survey and Benchmark" [Paper](https://arxiv.org/pdf/2311.06750) & [Github](https://github.com/WenkeHuang/MarsFL)â€”â€”Review on Federated Learning

+ **2021CVPR**  "Model-Contrastive Federated Learning" [Paper](https://arxiv.org/pdf/2103.16257) & [Github](https://github.com/QinbinLi/MOON)â€”â€”MOON(Alignment of Local and Global Model Representations)

+ **2022AAAI** "FedProto: Federated Prototype Learning across Heterogeneous Clients"[Paper](https://arxiv.org/pdf/2105.00243)â€”â€”FedProto(Alignment of Local and Global Prototype Representations)

+ **2023FGCS** "FedProc: Prototypical contrastive federated learning on non-IID data" [Paper](https://arxiv.org/pdf/2109.12273)â€”â€”FedProc(Alignment of Local and Global Prototype Representations)
  
+ **2020ICML** "SCAFFOLD:Stochastic Controlled Averaging for Federated Learning"[Paper](https://arxiv.org/pdf/1910.06378)â€”â€”SCAFFOLD(Alignment of Local and Global Optimization Directions)
  
+ **2021ICLR** "FEDERATED LEARNING BASED ON DYNAMIC REGULARIZATION"[Paper](https://arxiv.org/pdf/2111.04263)â€”â€”FedDyn(Alignment of Local and Global Losses)

+ **2022NeurIPS** "Preservation of the Global Knowledge by Not-True Distillation in Federated Learning" [Paper](https://arxiv.org/pdf/2106.03097 )â€”â€”FedNTD(Alignment of Unseen Local Losses with Global Losses)

+  **2021ICLR** "ADAPTIVE FEDERATED OPTIMIZATION"[Paper](https://arxiv.org/pdf/2003.00295)â€”â€”FedOpt(Server-Side Aggregation Optimization)

+ **2024CVPR**  "Fair Federated Learning under Domain Skew with Local Consistency and Domain Diversity"[Paper](https://arxiv.org/pdf/2405.16585) & [Github](https://github.com/yuhangchen0/FedHEAL)â€”â€”FedHEAL(Alignment of Local and Global Model Representations)

+ **2023WACV**  "Federated Domain Generalization for Image Recognition via Cross-Client Style Transfer"[Paper](https://arxiv.org/pdf/2210.00912) & [Github](https://chenjunming.ml/proj/CCST)â€”â€”CCST(Alignment of Local and Global Optimization Directions)

+ **2023TMC**  "FedFA: Federated Learning with Feature Anchors to Align Features and Classifiers for Heterogeneous Data"[Paper](https://arxiv.org/pdf/2211.09299)â€”â€”FedFA(Alignment of Features and Classifiers)

+ **2024AAAI** "CLIP-Guided Federated Learning on Heterogeneous and Long-Tailed Data"[Paper](https://arxiv.org/pdf/2312.08648)â€”â€”CLIP As Backbond For FL

+ **2023CVPR** "Rethinking Federated Learning with Domain Shift: A Prototype View"[Paper](https://openaccess.thecvf.com/content/CVPR2023/papers/Huang_Rethinking_Federated_Learning_With_Domain_Shift_A_Prototype_View_CVPR_2023_paper.pdf) & [Github](https://github.com/WenkeHuang/RethinkFL/tree/main)â€”â€”Cross-Domain Prototype Loss Alignment

+ **2023ICLR** "FEDFA: FEDERATED FEATURE AUGMENTATION" [Paper](https://arxiv.org/pdf/2301.12995) & [Github](https://github.com/tfzhou/FedFA)â€”â€”Class Prototype Gaussian Enhancement

+ **2021ICLR** "FEDMIX: APPROXIMATION OF MIXUP UNDER MEAN AUGMENTED FEDERATED LEARNING" [Paper](https://arxiv.org/pdf/2107.00233)â€”â€”Mixup For FL

+ **2021PMLR** "Data-Free Knowledge Distillation for Heterogeneous Federated Learning"  [Paper](https://arxiv.org/pdf/2105.10056)â€”â€”Data-Free Knowledge Distillation For FL

+ **2017ICML** "Communication-Efficient Learning of Deep Networks from Decentralized Data" [Paper](https://arxiv.org/pdf/1602.05629)â€”â€”FedAvg(Average aggregation)





